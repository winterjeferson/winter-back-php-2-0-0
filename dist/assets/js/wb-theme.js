class Blog{constructor(){this.cssLoadMore="loadMore",this.cssLoadMoreSelector=`[data-id="${this.cssLoadMore}"]`}build(){window.helper.getUrlWord("blog")&&(this.update(),this.buildMenu())}update(){this.page="pageBlog",this.elLastPost=document.querySelector(`#${this.page}LastPost`),this.elMostViewed=document.querySelector(`#${this.page}MostViewed`)}buildMenu(){if(!this.elLastPost||!this.elMostViewed)return;const e=this.elLastPost.querySelector(this.cssLoadMoreSelector),t=this.elMostViewed.querySelector(this.cssLoadMoreSelector);document.contains(e)&&e.addEventListener("click",()=>{this.loadMore(e)}),document.contains(t)&&t.addEventListener("click",()=>{this.loadMore(t)})}loadMore(e){let t=this,o=e.parentNode.parentNode.getAttribute("id"),l=o.substring(this.page.length),s=new XMLHttpRequest,r=window.url.getController({folder:"blog",file:"LoadMore"}),a="&target="+l;e.classList.add("disabled"),s.open("POST",r,!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.onreadystatechange=function(){4===s.readyState&&200===s.status&&(e.classList.remove("disabled"),t.loadMoreSuccess(o,s.responseText))},s.send(a)}loadMoreSuccess(e,t){let o=JSON.parse(t),l=document.querySelector("#"+e),s=l.querySelector(".blog-list"),r=l.querySelector('[data-id="'+this.cssLoadMore+'"]');o[this.cssLoadMore]||r.classList.add("disabled"),s.insertAdjacentHTML("beforeend",o.html),window.scrollTo(0,document.documentElement.scrollTop+1),window.scrollTo(0,document.documentElement.scrollTop-1)}}window.blog=new Blog;class WBForm{build(){window.helper.getUrlWord("form")&&(this.update(),this.buildMenu())}update(){this.elPage=document.querySelector("#pageForm"),this.elForm=this.elPage.querySelector(".form"),this.elFormFieldEmail=this.elForm.querySelector('[data-id="email"]'),this.elFormFieldMessage=this.elForm.querySelector('[data-id="message"]'),this.elButtonSend=this.elPage.querySelector("#pageFormBtSend")}buildMenu(){const e=this;this.elButtonSend.addEventListener("click",()=>{window.form.validateEmpty([e.elFormFieldEmail,e.elFormFieldMessage])&&e.send()})}send(){const e=this,t=new XMLHttpRequest,o=window.url.getController({folder:"form",file:"FormAjax"});let l="&method=sendForm&data="+JSON.stringify(e.getData())+"&token="+globalToken;this.elButtonSend.setAttribute("disabled","disabled"),t.open("POST",o,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){4===t.readyState&&200===t.status&&(e.elButtonSend.removeAttribute("disabled"),e.response(t.responseText))},t.send(l)}getData(){let e=[];return e.push(this.elForm.querySelector('[data-id="email"]').value),e.push(this.elForm.querySelector('[data-id="message"]').value),e}response(e){let t="",o="";switch(e){case"ok":o="green",t=globalTranslation.formSent;break;default:o="red",t=globalTranslation.formProblemSend}objWfNotification.add(t,o,this.elForm)}}window.wbForm=new WBForm;class WBTranslation{build(){this.update(),this.defineActive(),this.buildMenu()}buildMenu(){this.elSelect.addEventListener("change",e=>{const t=e.target.options.selectedIndex,o=e.target.options[t].getAttribute("data-url");window.location.replace(o)})}defineActive(){this.elSelect.value=globalLanguage}update(){this.elSelect=document.querySelector("#translationSelect")}}window.wbTranslation=new WBTranslation;class Url{buildSEO(e){return e.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"-").toLowerCase().replace(/&/g,"-and-").replace(/[^a-z0-9\-]/g,"").replace(/-+/g,"-").replace(/^-*/,"").replace(/-*$/,"")}build(e){window.location=globalUrl+globalLanguage+"/"+e+"/"}getController(e){return`./app/controller/${e.folder}/${e.file}.php`}watch(e,t){const o=this;e.addEventListener("focusout",function(){t.value=o.buildSEO(e.value)})}}window.url=new Url,document.addEventListener("DOMContentLoaded",()=>{window.wbTranslation.build(),window.blog.build(),window.wbForm.build()});